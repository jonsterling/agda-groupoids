{-# OPTIONS --sized-types --without-K #-}

module Groupoid.Homotopy where

open import Agda.Primitive
import Groupoid.Base as G
import Groupoid.Exponential.Boot as ╬а
import Setoid as S
open import Type as T
  using (_,_)

infixr 0 _РЄњРѓЂ_

record _РЄњРѓЂ_ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  (F G : A ╬а.РЄњРѓђрхЌ B)
    : Set (РёЊРѓђрхњ Ріћ (РёЊРѓЂ╦брхњ Ріћ РёЊРѓЂ╦б╩░)) where
  constructor nat
  field
    com : Рѕђ {a} Рєњ S.obj (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a))
{-# NO_ETA _РЄњРѓЂ_ #-}
open _РЄњРѓЂ_ public

idn
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ T.­ЮЪЎ.t T.╬а.РЄњРѓђ (F РЄњРѓЂ F)
com (idn {B = B} F x) = G.idn╦брхљ B S.╬а.$Рѓђ x

cmp
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {F G H : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (G РЄњРѓЂ H) T.Рѕљ.РіЌ (F РЄњРѓЂ G)
  Рєњ F РЄњРѓЂ H
com (cmp {B = B} (╬▓ , ╬▒)) = G.cmp╦брхљ B S.╬а.$Рѓђ (com ╬▓ , com ╬▒)

inv
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (F РЄњРѓЂ G) T.╬а.РЄњРѓђ (G РЄњРѓЂ F)
com (inv {B = B} ╬▒) = G.inv╦брхљ B S.╬а.$Рѓђ (com ╬▒)

cmp-wРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (H╬▒ : (B ╬а.РЄњРѓђрхЌ C) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ G)
com (cmp-wРѓђ (H , ╬▒)) = H ╬а.$РѓЂ com ╬▒

cmp-wРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {G H : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓F : (G РЄњРѓЂ H) T.Рѕљ.РіЌ (A ╬а.РЄњРѓђрхЌ B))
  Рєњ (G ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F) РЄњРѓЂ (H ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F)
com (cmp-wРѓЂ (╬▓ , F)) = com ╬▓

cmp-hРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (K ╬а.РѕўрхЌрхљ G)
com (cmp-hРѓђ {C = C} {K = K} (╬▓ , ╬▒)) = G.cmp╦брхљ C S.╬а.$Рѓђ (K ╬а.$РѓЂ com ╬▒ , com ╬▓)

cmp-hРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (K ╬а.РѕўрхЌрхљ G)
com (cmp-hРѓЂ {C = C} {H = H} (╬▓ , ╬▒)) = G.cmp╦брхљ C S.╬а.$Рѓђ (com ╬▓ , H ╬а.$РѓЂ com ╬▒)
