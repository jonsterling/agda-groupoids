{-# OPTIONS --without-K #-}

module Groupoid.Transfor where

open import Agda.Primitive
import Groupoid.Base as G
import Groupoid.Exponential.Boot as ╬а
import Setoid as S
open import Type as T
  using (_,_)

infixr 0 _РЄњРѓЂрхЌ_

record _РЄњРѓЂрхЌ_
  {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  (F G : A ╬а.РЄњРѓђрхЌ B)
    : Set ((РёЊРѓђрхњ Ріћ РёЊРѓђ╦брхњ) Ріћ (РёЊРѓЂ╦брхњ Ріћ РёЊРѓЂ╦б╩░)) where
  no-eta-equality
  field
    comРѓЂ
      : Рѕђ {a}
      Рєњ S.obj (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a))
  field
    .natРѓЂ
      : Рѕђ {a b}
      Рєњ (f : S.obj (G.hom╦б A (a , b)))
      Рєњ S.homрхЌ (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ b))
          ( G.cmp╦брхљ B S.╬а.$Рѓђ (comРѓЂ {b} , F ╬а.$РѓЂ f)
          , G.cmp╦брхљ B S.╬а.$Рѓђ (G ╬а.$РѓЂ f , comРѓЂ {a})
          )
open _РЄњРѓЂрхЌ_ public

record _РЄњРѓѓ_
  {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  {F G : A ╬а.РЄњРѓђрхЌ B}
  (╬▒ ╬▓ : F РЄњРѓЂрхЌ G)
    : Set (РёЊРѓђрхњ Ріћ (РёЊРѓЂ╦брхњ Ріћ РёЊРѓЂ╦б╩░)) where
  no-eta-equality
  field
    .comРѓѓ
      : Рѕђ {a}
      Рєњ S.homрхЌ (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)) (comРѓЂ ╬▒ {a} , comРѓЂ ╬▓ {a})
open _РЄњРѓѓ_ public

_РЄњРѓЂ╦б_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ (F G : A ╬а.РЄњРѓђрхЌ B)
  Рєњ S.t d _ _
S.obj (_РЄњРѓЂ╦б_ F G) =
  F РЄњРѓЂрхЌ G
S.homрхЌ (_РЄњРѓЂ╦б_ F G) =
  ╬╗ {(╬▒ , ╬▓) Рєњ ╬▒ РЄњРѓѓ ╬▓}
comРѓѓ (S.idnрхЌрхљ (_РЄњРѓЂ╦б_ {B = B} F G) _) = ╬╗ {a} Рєњ
  S.idnрхЌрхљ (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)) _
comРѓѓ (S.cmpрхЌрхљ (_РЄњРѓЂ╦б_ {B = B} F G) (gРЄњРѓѓ , fРЄњРѓѓ)) = ╬╗ {a} Рєњ
  S.cmpрхЌрхљ (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a))
    (comРѓѓ gРЄњРѓѓ {a} , comРѓѓ fРЄњРѓѓ {a})
S.invрхЌрхљ (_РЄњРѓЂ╦б_ {S.Dir.РЅц} F G) = _
comРѓѓ (S.invрхЌрхљ (_РЄњРѓЂ╦б_ {S.Dir.РЅѕ} {B = B} F G) fРЄњРѓѓ) = ╬╗ {a} Рєњ
  S.invрхЌрхљ (G.hom╦б B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a))
    (comРѓѓ fРЄњРѓѓ {a})

idn╦брхљ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ S.­ЮЪЎ.s S.╬а.РЄњРѓђрхЌ (F РЄњРѓЂ╦б F)
comРѓЂ (S.╬а._$Рѓђ_ (idn╦брхљ {B = B} F) x) =
  G.idn╦брхљ B S.╬а.$Рѓђ x
natРѓЂ (S.╬а._$Рѓђ_ (idn╦брхљ {B = B} F) x) = ╬╗ {a b} f Рєњ
  S.cmpрхЌрхљ (G.hom╦б B (F ╬а.$Рѓђ a , F ╬а.$Рѓђ b))
    ( G.idn-rhs B (F ╬а.$РѓЂ f)
    , G.idn-lhs B (F ╬а.$РѓЂ f) )
comРѓѓ (S.╬а._$РѓЂ_ (idn╦брхљ {B = B} F) x) =
  G.idn╦брхљ B S.╬а.$РѓЂ x

cmp╦брхљ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {A : G.t S.Dir.РЅѕ РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.t S.Dir.РЅѕ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {F G H : A ╬а.РЄњРѓђрхЌ B}
  Рєњ ((G РЄњРѓЂ╦б H) S.Рѕљ.РіЌ (F РЄњРѓЂ╦б G)) S.╬а.РЄњРѓђрхЌ (F РЄњРѓЂ╦б H)
comРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ {B = B}) (╬▓ , ╬▒)) =
  G.cmp╦брхљ B S.╬а.$Рѓђ (comРѓЂ ╬▓ , comРѓЂ ╬▒)
natРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ {B = B}) (╬▓ , ╬▒)) = ╬╗ f Рєњ
  S.cmpрхЌрхљ (G.hom╦б B _)
  ( G.cmp-ass B _ _ _
  , S.cmpрхЌрхљ (G.hom╦б B _)
    ( G.cmp╦брхљ B S.╬а.$РѓЂ (natРѓЂ ╬▓ _ , S.idnрхЌрхљ (G.hom╦б B _) _)
    , S.cmpрхЌрхљ (G.hom╦б B _)
      ( S.invрхЌрхљ (G.hom╦б B _) (G.cmp-ass B _ _ _)
      , S.cmpрхЌрхљ (G.hom╦б B _)
        ( G.cmp╦брхљ B S.╬а.$РѓЂ (S.idnрхЌрхљ (G.hom╦б B _) _ , natРѓЂ ╬▒ _)
        , G.cmp-ass B _ _ _ ))))
comРѓѓ (S.╬а._$РѓЂ_ (cmp╦брхљ {B = B}) (╬▓ , ╬▒)) =
  G.cmp╦брхљ B S.╬а.$РѓЂ (comРѓѓ ╬▓ , comРѓѓ ╬▒)

-- inv╦брхљ
--   : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
--   Рєњ {A : G.t S.Dir.РЅѕ РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
--   Рєњ {B : G.t S.Dir.РЅѕ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
--   Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
--   Рєњ (F РЄњРѓЂ╦б G) S.╬а.РЄњРѓђрхЌ (G РЄњРѓЂ╦б F)
-- comРѓЂ (S.╬а._$Рѓђ_ (inv╦брхљ {B = B}) ╬▒) =
--   G.inv╦брхљ B S.╬а.$Рѓђ (comРѓЂ ╬▒)
-- natРѓЂ (S.╬а._$Рѓђ_ (inv╦брхљ {A = A}{B = B}{F}{G}) ╬▒) = ╬╗ {a b} f Рєњ
--   {!!}
-- comРѓѓ (S.╬а._$РѓЂ_ (inv╦брхљ {B = B}) ╬▒) =
--   G.inv╦брхљ B S.╬а.$РѓЂ (comРѓѓ ╬▒)

-- FIXME: cmp-wРѓђ and cmp-wРѓђ are problematic because of H╬▒/╬▓F dependency

-- cmp-wРѓђ
--   : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
--   Рєњ (H╬▒ : (B ╬а.РЄњРѓђрхЌ C) T.Рѕљ.РіЌ (F РЄњРѓЂрхЌ G))
--   Рєњ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ F) РЄњРѓЂрхЌ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ G)
-- comРѓЂ (cmp-wРѓђ (H , ╬▒)) = H ╬а.$РѓЂ comРѓЂ ╬▒

-- cmp-wРѓЂ
--   : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {A : G.t РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░} {B : G.t РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░} {C : G.t РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {G H : B ╬а.РЄњРѓђрхЌ C}
--   Рєњ (╬▓F : (G РЄњРѓЂрхЌ H) T.Рѕљ.РіЌ (A ╬а.РЄњРѓђрхЌ B))
--   Рєњ (G ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F) РЄњРѓЂрхЌ (H ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F)
-- comРѓЂ (cmp-wРѓЂ (╬▓ , F)) = comРѓЂ ╬▓

-- cmp╦брхљ-hРѓђ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
--   Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
--   Рєњ {C : G.t d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
--   Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
--   Рєњ ((H РЄњРѓЂ╦б K) S.Рѕљ.РіЌ (F РЄњРѓЂ╦б G)) S.╬а.РЄњРѓђрхЌ ((H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ╦б (K ╬а.РѕўрхЌрхљ G))
-- comРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ-hРѓђ {C = C} {K = K}) (╬▓ , ╬▒)) =
--   G.cmp╦брхљ C S.╬а.$Рѓђ (K ╬а.$РѓЂ comРѓЂ ╬▒ , comРѓЂ ╬▓)
-- natРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ-hРѓђ {C = C} {K = K}) (╬▓ , ╬▒)) = ╬╗ f Рєњ
--   {!!}
-- comРѓѓ (S.╬а._$РѓЂ_ (cmp╦брхљ-hРѓђ {C = C} {K = K}) (╬▓ , ╬▒)) =
--   G.cmp╦брхљ C S.╬а.$РѓЂ (K ╬а.$Рѓѓ comРѓѓ ╬▒ , comРѓѓ ╬▓)

-- cmp╦брхљ-hРѓЂ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
--   Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
--   Рєњ {C : G.t d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
--   Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
--   Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
--   Рєњ ((H РЄњРѓЂ╦б K) S.Рѕљ.РіЌ (F РЄњРѓЂ╦б G)) S.╬а.РЄњРѓђрхЌ ((H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ╦б (K ╬а.РѕўрхЌрхљ G))
-- comРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ-hРѓЂ {C = C} {H = H}) (╬▓ , ╬▒)) =
--   G.cmp╦брхљ C S.╬а.$Рѓђ (comРѓЂ ╬▓ , H ╬а.$РѓЂ comРѓЂ ╬▒)
-- natРѓЂ (S.╬а._$Рѓђ_ (cmp╦брхљ-hРѓЂ {C = C} {H = H}) (╬▓ , ╬▒)) =
--   {!!}
-- comРѓѓ (S.╬а._$РѓЂ_ (cmp╦брхљ-hРѓЂ {C = C} {H = H}) (╬▓ , ╬▒)) =
--   G.cmp╦брхљ C S.╬а.$РѓЂ (comРѓѓ ╬▓ , H ╬а.$Рѓѓ comРѓѓ ╬▒)
