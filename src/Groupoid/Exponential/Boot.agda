{-# OPTIONS --without-K #-}

module Groupoid.Exponential.Boot where

open import Agda.Primitive
import Groupoid.Base as G
import Setoid as S
open import Type as T
  using (_,_)

record _РЄњРѓђрхЌ_
  {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  (A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░)
  (B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░)
    : Set ((РёЊРѓђрхњ Ріћ РёЊРѓђ╦брхњ Ріћ РёЊРѓђ╦б╩░) Ріћ (РёЊРѓЂрхњ Ріћ РёЊРѓЂ╦брхњ Ріћ РёЊРѓЂ╦б╩░)) where
  no-eta-equality
  infixr 4 _$Рѓђ_
  infixr 4 _$РѓЂ_
  field
    _$Рѓђ_ : G.obj A T.╬а.РЄњРѓђ G.obj B
    -$РѓЂ╦брхљ- : Рѕђ {a b} Рєњ G.hom╦б A (a , b) S.╬а.РЄњРѓђрхЌ G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b)

  _$РѓЂ_
    : Рѕђ {a b}
    Рєњ S.obj (G.hom╦б A (a , b))
    T.╬а.РЄњРѓђ S.obj (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b))
  _$РѓЂ_ = ╬╗ {_ _} Рєњ S.╬а._$Рѓђ_ -$РѓЂ╦брхљ-

  _$Рѓѓ_
    : Рѕђ {a b} {f g : S.obj (G.hom╦б A (a , b))}
    Рєњ S.homрхЌ (G.hom╦б A (a , b)) (f , g)
    T.╬а.РЄњРѓђ S.homрхЌ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b)) (-$РѓЂ╦брхљ- S.╬а.$Рѓђ f , -$РѓЂ╦брхљ- S.╬а.$Рѓђ g)
  _$Рѓѓ_ = ╬╗ {_ _ f g} Рєњ S.╬а._$РѓЂ_ -$РѓЂ╦брхљ- {f} {g}

  field
    .idn
      : Рѕђ {a}
      Рєњ S.homрхЌ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ a))
          ( -$РѓЂ╦брхљ- S.╬а.$Рѓђ (G.idn╦брхљ A {a} S.╬а.$Рѓђ T.­ЮЪЎ.*)
          , G.idn╦брхљ B {_$Рѓђ_ a} S.╬а.$Рѓђ T.­ЮЪЎ.*
          )
    .cmp
      : Рѕђ {a b c}
      Рєњ (g : S.obj (G.hom╦б A (b , c)))
      Рєњ (f : S.obj (G.hom╦б A (a , b)))
      Рєњ S.homрхЌ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ c))
          ( -$РѓЂ╦брхљ- S.╬а.$Рѓђ (G.cmp╦брхљ A S.╬а.$Рѓђ (g , f))
          , G.cmp╦брхљ B S.╬а.$Рѓђ (-$РѓЂ╦брхљ- S.╬а.$Рѓђ g , -$РѓЂ╦брхљ- S.╬а.$Рѓђ f)
          )
open _РЄњРѓђрхЌ_ public

idnрхЌрхљ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ T.­ЮЪЎ.tРЂ░ T.╬а.РЄњРѓђ (A РЄњРѓђрхЌ A)
_$Рѓђ_ (idnрхЌрхљ T.­ЮЪЎ.*) =
  T.╬а.idn
-$РѓЂ╦брхљ- (idnрхЌрхљ T.­ЮЪЎ.*) =
  S.╬а.idnрхЌрхљ _
idn (idnрхЌрхљ {A = A} T.­ЮЪЎ.*) =
  G.idn╦брхљ A S.╬а.$РѓЂ T.­ЮЪЎ.*
cmp (idnрхЌрхљ {A = A} T.­ЮЪЎ.*) = ╬╗ g f Рєњ
  G.cmp╦брхљ A S.╬а.$РѓЂ
    ( S.idnрхЌрхљ (G.hom╦б A _) T.­ЮЪЎ.*
    , S.idnрхЌрхљ (G.hom╦б A _) T.­ЮЪЎ.*
    )

cmpрхЌрхљ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {C : G.t d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ (B РЄњРѓђрхЌ C) T.Рѕљ.РіЌ (A РЄњРѓђрхЌ B) T.╬а.РЄњРѓђ (A РЄњРѓђрхЌ C)
_$Рѓђ_ (cmpрхЌрхљ (G , F)) =
  T.╬а.cmp (G $Рѓђ_ , F $Рѓђ_)
-$РѓЂ╦брхљ- (cmpрхЌрхљ (G , F)) =
  S.╬а.cmpрхЌрхљ (-$РѓЂ╦брхљ- G , -$РѓЂ╦брхљ- F)
idn (cmpрхЌрхљ {C = C} (G , F)) = ╬╗ {_} Рєњ
  -- FIXME (whiskering)
  S.cmpрхЌрхљ (G.hom╦б C _)
    ( idn G
    , G $Рѓѓ idn F
    )
cmp (cmpрхЌрхљ {C = C} (G , F)) = ╬╗ {_ _ _} _ _ Рєњ
  -- FIXME (whiskering)
  S.cmpрхЌрхљ (G.hom╦б C _)
    ( cmp G _ _
    , G $Рѓѓ (cmp F _ _)
    )

_РѕўрхЌрхљ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.t d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.t d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {C : G.t d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ (B РЄњРѓђрхЌ C) T.╬а.РЄњРѓђ (A РЄњРѓђрхЌ B) T.╬а.РЄњРѓђ (A РЄњРѓђрхЌ C)
_РѕўрхЌрхљ_ G F = cmpрхЌрхљ (G , F)
