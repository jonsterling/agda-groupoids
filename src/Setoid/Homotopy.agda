{-# OPTIONS --sized-types --without-K #-}

module Setoid.Homotopy where

open import Agda.Primitive
import Setoid.Base as S
import Setoid.Exponential.Boot as ╬а
import Setoid.Path as Path
import Setoid.Terminal as ­ЮЪЎ
open import Type as T
  using (_,_)

infixr 0 _РЄњРѓЂ_

record _РЄњРѓЂ_ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░}
  {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  (F G : A ╬а.РЄњРѓђрхЌ B)
    : Set (РёЊРѓђрхњ Ріћ РёЊРѓЂ╩░) where
  constructor nat
  field
    com : Рѕђ {a} Рєњ S.homрхЌ B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)
{-# NO_ETA _РЄњРѓЂ_ #-}
open _РЄњРѓЂ_ public

comРђ▓
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ Рѕђ {a} (╬▒ : F РЄњРѓЂ G) Рєњ S.homрхЌ B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)
comРђ▓ ╬▒ = com ╬▒

idn
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ T.­ЮЪЎ.t T.╬а.РЄњРѓђ (F РЄњРѓЂ F)
com (idn {B = B} F x) = S.idnрхЌрхљ B x

cmp
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G H : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (G РЄњРѓЂ H) T.Рѕљ.РіЌ (F РЄњРѓЂ G)
  Рєњ F РЄњРѓЂ H
com (cmp {B = B} (╬▓ , ╬▒)) = S.cmpрхЌрхљ B (com ╬▓ , com ╬▒)

inv
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (F РЄњРѓЂ G) T.╬а.РЄњРѓђ (G РЄњРѓЂ F)
com (inv {B = B} ╬▒) = S.invрхЌрхљ B (com ╬▒)

cmp-wРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░ }
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (H╬▒ : (B ╬а.РЄњРѓђрхЌ C) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌрхљ G)
com (cmp-wРѓђ (H , ╬▒)) = H ╬а.$РѓЂ com ╬▒

cmp-wРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {G H : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓F : (G РЄњРѓЂ H) T.Рѕљ.РіЌ (A ╬а.РЄњРѓђрхЌ B))
  Рєњ (G ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F) РЄњРѓЂ (H ╬а.РѕўрхЌрхљ T.Рѕљ.¤ђРѓЂ ╬▓F)
com (cmp-wРѓЂ (╬▓ , F)) = com ╬▓

cmp-hРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (K ╬а.РѕўрхЌрхљ G)
com (cmp-hРѓђ {C = C} {K = K} (╬▓ , ╬▒)) = S.cmpрхЌрхљ C (K ╬а.$РѓЂ com ╬▒ , com ╬▓)

cmp-hРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌрхљ F) РЄњРѓЂ (K ╬а.РѕўрхЌрхљ G)
com (cmp-hРѓЂ {C = C} {H = H} (╬▓ , ╬▒)) = S.cmpрхЌрхљ C (com ╬▓ , H ╬а.$РѓЂ com ╬▒)
