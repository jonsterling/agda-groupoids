{-# OPTIONS --without-K #-}

module Setoid.Core.Exponential where

open import Agda.Primitive
import Setoid.Core.Base as S
open import Setoid.Core.Exponential.Boot public
import Setoid.Core.Homotopy as TFor
open import Setoid.Core.Tensor.Boot as Рѕљ
import Setoid.Core.Terminal as ­ЮЪЎ
open import Type as T
  using (_,_)

infixr 2 _РЄњРѓђ╦б_
infixr 2 _РѕўРѓђ_
infixr 2 _РѕўРѓЂ_

_РЄњРѓђ╦б_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░)
  Рєњ (B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░)
  Рєњ S.t d _ _
S.obj (A РЄњРѓђ╦б B) =
  A РЄњРѓђрхЌ B
S.homрхЌ (A РЄњРѓђ╦б B) =
  ╬╗ {(F , G) Рєњ F TFor.РЄњРѓЂ G}
S.idnрхЌрхљ (A РЄњРѓђ╦б B) =
  TFor.idnрхЌрхљ _
S.cmpрхЌрхљ (A РЄњРѓђ╦б B) =
  TFor.cmpрхЌрхљ
S.invрхЌрхљ (_РЄњРѓђ╦б_ {S.Dir.РЅц} A B) =
  _
S.invрхЌрхљ (_РЄњРѓђ╦б_ {S.Dir.РЅѕ} A B) =
  TFor.invрхЌрхљ

idn
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ ­ЮЪЎ.s РЄњРѓђрхЌ (A РЄњРѓђ╦б A)
_$Рѓђ_ idn = idnрхЌрхљ
_$РѓЂ_ idn = TFor.idnрхЌрхљ _

cmp
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ (B РЄњРѓђ╦б C) Рѕљ.РіЌ (A РЄњРѓђ╦б B) РЄњРѓђрхЌ (A РЄњРѓђ╦б C)
_$Рѓђ_ cmp = cmpрхЌрхљ
_$РѓЂ_ cmp = TFor.cmpрхЌрхљ-hРѓЂ

_РѕўРѓђ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ (G : B РЄњРѓђрхЌ C)
  Рєњ (F : A РЄњРѓђрхЌ B)
  Рєњ (A РЄњРѓђрхЌ C)
G РѕўРѓђ F = G РѕўрхЌрхљ F

_РѕўРѓЂ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A РЄњРѓђрхЌ B}
  Рєњ {H K : B РЄњРѓђрхЌ C}
  Рєњ (╬▓ : H TFor.РЄњРѓЂ K)
  Рєњ (╬▒ : F TFor.РЄњРѓЂ G)
  Рєњ (H РѕўрхЌрхљ F) TFor.РЄњРѓЂ (K РѕўрхЌрхљ G)
╬▓ РѕўРѓЂ ╬▒ = cmp $РѓЂ (╬▓ , ╬▒)

! : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ S.obj A Рєњ (B РЄњРѓђрхЌ A)
_$Рѓђ_ (! a) = T.╬а.! a
_$РѓЂ_ (! {A = A} _) = T.╬а.! (S.idnрхЌрхљ A T.­ЮЪЎ.*)
