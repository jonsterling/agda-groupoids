{-# OPTIONS --without-K #-}

module Setoid.Core.Homotopy where

open import Agda.Primitive
import Setoid.Core.Base as S
import Setoid.Core.Discrete as Discrete
import Setoid.Core.Hom.Boot as ╬а
import Setoid.Core.Terminal as ­ЮЪЎ
open import Type as T
  using (_,_)

infixr 0 _РЄњРѓЂ_

record _РЄњРѓЂ_
  {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  (F G : A ╬а.РЄњРѓђрхЌ B)
    : Set (РёЊРѓђрхњ Ріћ РёЊРѓЂ╩░) where
  no-eta-equality
  field
    .comРѓЂ
      : Рѕђ {a}
      Рєњ S.homрхЌ B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)
open _РЄњРѓЂ_ public

.comРѓЂрхЌРђ▓
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ Рѕђ {a} (╬▒ : F РЄњРѓЂ G)
  Рєњ S.homрхЌ B (F ╬а.$Рѓђ a , G ╬а.$Рѓђ a)
comРѓЂрхЌРђ▓ ╬▒ = comРѓЂ ╬▒

idnрхЌ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ T.­ЮЪЎ.t T.╬а.РЄњРѓђ (F РЄњРѓЂ F)
comРѓЂ (idnрхЌ {B = B} F x) = S.idnрхЌ B x

cmpрхЌ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G H : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (G РЄњРѓЂ H) T.Рѕљ.РіЌ (F РЄњРѓЂ G)
  Рєњ F РЄњРѓЂ H
comРѓЂ (cmpрхЌ {B = B} (╬▓ , ╬▒)) =
  S.cmpрхЌ B (comРѓЂ ╬▓ , comРѓЂ ╬▒)

invрхЌ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t S.Dir.РЅѕ РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t S.Dir.РЅѕ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (F РЄњРѓЂ G) T.╬а.РЄњРѓђ (G РЄњРѓЂ F)
comРѓЂ (invрхЌ {B = B} ╬▒) = S.invрхЌ B (comРѓЂ ╬▒)

cmpрхЌ-wРѓђ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░ }
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (H╬▒ : (B ╬а.РЄњРѓђрхЌ C) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌ F) РЄњРѓЂ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌ G)
comРѓЂ (cmpрхЌ-wРѓђ (H , ╬▒)) = H ╬а.$РѓЂ comРѓЂ ╬▒

cmpрхЌ-wРѓЂ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {G H : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓F : (G РЄњРѓЂ H) T.Рѕљ.РіЌ (A ╬а.РЄњРѓђрхЌ B))
  Рєњ (G ╬а.РѕўрхЌ T.Рѕљ.¤ђРѓЂ ╬▓F) РЄњРѓЂ (H ╬а.РѕўрхЌ T.Рѕљ.¤ђРѓЂ ╬▓F)
comРѓЂ (cmpрхЌ-wРѓЂ (╬▓ , F)) = comРѓЂ ╬▓

cmpрхЌ-hРѓђ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌ F) РЄњРѓЂ (K ╬а.РѕўрхЌ G)
comРѓЂ (cmpрхЌ-hРѓђ {C = C} {K = K} (╬▓ , ╬▒)) =
  S.cmpрхЌ C (K ╬а.$РѓЂ comРѓЂ ╬▒ , comРѓЂ ╬▓)

cmpрхЌ-hРѓЂ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.РіЌ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌ F) РЄњРѓЂ (K ╬а.РѕўрхЌ G)
comРѓЂ (cmpрхЌ-hРѓЂ {C = C} {H = H} (╬▓ , ╬▒)) =
  S.cmpрхЌ C (comРѓЂ ╬▓ , H ╬а.$РѓЂ comРѓЂ ╬▒)
