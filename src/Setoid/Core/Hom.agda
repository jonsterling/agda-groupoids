{-# OPTIONS --without-K #-}

module Setoid.Core.Hom where

open import Agda.Primitive
import Setoid.Core.Base as S
import Setoid.Core.Hom.Boot as ╬а
import Setoid.Core.Homotopy as TF
open import Setoid.Core.Tensor.Boot as Рѕљ
import Setoid.Core.Terminal as ­ЮЪЎ
open import Type as T
  using (_,_)

infixr 2 _РЄњРѓђ╦б_
infixr 2 _РѕўРѓђ_
infixr 2 _РѕўРѓЂ_

_РЄњРѓђ╦б_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░)
  Рєњ (B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░)
  Рєњ S.t d _ _
S.obj (A РЄњРѓђ╦б B) =
  A ╬а.РЄњРѓђрхЌ B
S.homрхЌ (A РЄњРѓђ╦б B) =
  ╬╗ {(F , G) Рєњ F TF.РЄњРѓЂ G}
S.idnрхЌ (A РЄњРѓђ╦б B) =
  TF.idnРѓЂрхЌ _
S.cmpрхЌ (A РЄњРѓђ╦б B) =
  TF.cmpРѓЂрхЌ
S.invрхЌ (_РЄњРѓђ╦б_ {S.Dir.РЅц} A B) =
  _
S.invрхЌ (_РЄњРѓђ╦б_ {S.Dir.РЅѕ} A B) =
  TF.invРѓЂрхЌ

idnРѓђ╦б
  : Рѕђ {d} ..{РёЊрхњ РёЊ╩░}
  Рєњ {A : S.t d РёЊрхњ РёЊ╩░}
  Рєњ ­ЮЪЎ.s ╬а.РЄњРѓђрхЌ (A РЄњРѓђ╦б A)
╬а._$Рѓђ_ idnРѓђ╦б = ╬а.idnРѓђрхЌ
╬а._$РѓЂ_ idnРѓђ╦б = TF.idnРѓЂрхЌ _

cmpРѓђ╦б
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ (B РЄњРѓђ╦б C) Рѕљ.РіЌ (A РЄњРѓђ╦б B) ╬а.РЄњРѓђрхЌ (A РЄњРѓђ╦б C)
╬а._$Рѓђ_ cmpРѓђ╦б = ╬а.cmpРѓђрхЌ
╬а._$РѓЂ_ cmpРѓђ╦б = TF.cmpРѓЂрхЌ-hРѓЂ

!╦б : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ S.obj A Рєњ (B ╬а.РЄњРѓђрхЌ A)
╬а._$Рѓђ_ (!╦б a) = T.╬а.! a
╬а._$РѓЂ_ (!╦б {A = A} _) = T.╬а.! (S.idnрхЌ A T.­ЮЪЎ.*)

_РѕўРѓђ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ (G : B ╬а.РЄњРѓђрхЌ C)
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ (A ╬а.РЄњРѓђрхЌ C)
G РѕўРѓђ F = G ╬а.РѕўРѓђрхЌ F

._РѕўРѓЂ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.t d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {C : S.t d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓ : H TF.РЄњРѓЂ K)
  Рєњ (╬▒ : F TF.РЄњРѓЂ G)
  Рєњ (H ╬а.РѕўРѓђрхЌ F) TF.РЄњРѓЂ (K ╬а.РѕўРѓђрхЌ G)
╬▓ РѕўРѓЂ ╬▒ = cmpРѓђ╦б ╬а.$РѓЂ (╬▓ , ╬▒)

open import Setoid.Core.Hom.Boot public
