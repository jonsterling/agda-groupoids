{-# OPTIONS --without-K #-}

module Ambient.Groupoid.Map.Boot where

open import Agda.Primitive
import Ambient.Groupoid.Base as G
import Setoid as S
open import Type as T

infixr 1 _РЄњРѓђрхЌ_
infixr 2 _РѕўРѓђрхЌ_

record _РЄњРѓђрхЌ_
  {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  (A : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░)
  (B : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░)
    : Set ((РёЊРѓђрхњ Ріћ РёЊРѓђ╦брхњ Ріћ РёЊРѓђ╦б╩░) Ріћ (РёЊРѓЂрхњ Ріћ РёЊРѓЂ╦брхњ Ріћ РёЊРѓЂ╦б╩░)) where
  no-eta-equality
  infixr 4 _$Рѓђ_
  infixr 4 _$РѓЂ_
  field
    _$Рѓђ_ : G.obj A РЄњРѓђ,Рѓђ G.obj B
    -$РѓЂ╦б- : Рѕђ {a b} Рєњ G.hom╦б A (a , b) S.Map.РЄњРѓђрхЌ G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b)

  _$РѓЂ_
    : Рѕђ {a b}
    Рєњ S.cellРѓђ (G.hom╦б A (a , b))
    РЄњРѓђ,Рѓђ S.cellРѓђ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b))
  _$РѓЂ_ = ╬╗ {_ _} Рєњ S.Map._$Рѓђ_ -$РѓЂ╦б-

  ._$Рѓѓ_
    : Рѕђ {a b} {f g : S.cellРѓђ (G.hom╦б A (a , b))}
    Рєњ S.cellРѓЂ (G.hom╦б A (a , b)) (f , g)
    РЄњРѓђ,Рѓђ S.cellРѓЂ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ b)) (-$РѓЂ╦б- S.Map.$Рѓђ f , -$РѓЂ╦б- S.Map.$Рѓђ g)
  _$Рѓѓ_ = ╬╗ {_ _ f g} Рєњ S.Map._$РѓЂ_ -$РѓЂ╦б- {f} {g}

  field
    .idn
      : Рѕђ {a}
      Рєњ S.cellРѓЂ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ a))
          ( -$РѓЂ╦б- S.Map.$Рѓђ (G.idn╦б A {a} S.Map.$Рѓђ *)
          , G.idn╦б B {_$Рѓђ_ a} S.Map.$Рѓђ *
          )
    .cmp
      : Рѕђ {a b c}
      Рєњ (g : S.cellРѓђ (G.hom╦б A (b , c)))
      Рєњ (f : S.cellРѓђ (G.hom╦б A (a , b)))
      Рєњ S.cellРѓЂ (G.hom╦б B (_$Рѓђ_ a , _$Рѓђ_ c))
          ( -$РѓЂ╦б- S.Map.$Рѓђ (G.cmp╦б A S.Map.$Рѓђ (g , f))
          , G.cmp╦б B S.Map.$Рѓђ (-$РѓЂ╦б- S.Map.$Рѓђ g , -$РѓЂ╦б- S.Map.$Рѓђ f)
          )
open _РЄњРѓђрхЌ_ public

idnРѓђрхЌ
  : Рѕђ {d} ..{РёЊрхњ РёЊ╦брхњ РёЊ╦б╩░}
  Рєњ {A : G.­ЮћіРѓѓ,Рѓђ d РёЊрхњ РёЊ╦брхњ РёЊ╦б╩░}
  Рєњ ­ЮЪЎРѓђ {lzero} РЄњРѓђ,Рѓђ (A РЄњРѓђрхЌ A)
_$Рѓђ_ (idnРѓђрхЌ *) =
  РЄњРѓђ.idnРѓђ
-$РѓЂ╦б- (idnРѓђрхЌ *) =
  S.Map.idnРѓђрхЌ _
idn (idnРѓђрхЌ {A = A} *) =
  G.idn╦б A S.Map.$РѓЂ *
cmp (idnРѓђрхЌ {A = A} *) = ╬╗ g f Рєњ
  G.cmp╦б A S.Map.$РѓЂ
    ( S.idn (G.hom╦б A _) *
    , S.idn (G.hom╦б A _) *
    )

cmpРѓђрхЌ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {C : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ (B РЄњРѓђрхЌ C) ├ЌРѓђ (A РЄњРѓђрхЌ B) РЄњРѓђ,Рѓђ (A РЄњРѓђрхЌ C)
_$Рѓђ_ (cmpРѓђрхЌ (G , F)) =
  РЄњРѓђ.cmpРѓђ (G $Рѓђ_ , F $Рѓђ_)
-$РѓЂ╦б- (cmpРѓђрхЌ (G , F)) =
  S.Map.cmpРѓђрхЌ (-$РѓЂ╦б- G , -$РѓЂ╦б- F)
idn (cmpРѓђрхЌ {C = C} (G , F)) = ╬╗ {_} Рєњ
  -- FIXME (whiskering)
  S.cmp (G.hom╦б C _)
    ( idn G
    , G $Рѓѓ idn F
    )
cmp (cmpРѓђрхЌ {C = C} (G , F)) = ╬╗ {_ _ _} _ _ Рєњ
  -- FIXME (whiskering)
  S.cmp (G.hom╦б C _)
    ( cmp G _ _
    , G $Рѓѓ (cmp F _ _)
    )

_РѕўРѓђрхЌ_
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░ РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░ РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ {A : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓђрхњ РёЊРѓђ╦брхњ РёЊРѓђ╦б╩░}
  Рєњ {B : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓЂрхњ РёЊРѓЂ╦брхњ РёЊРѓЂ╦б╩░}
  Рєњ {C : G.­ЮћіРѓѓ,Рѓђ d РёЊРѓѓрхњ РёЊРѓѓ╦брхњ РёЊРѓѓ╦б╩░}
  Рєњ (B РЄњРѓђрхЌ C) РЄњРѓђ,Рѓђ (A РЄњРѓђрхЌ B) РЄњРѓђ,Рѓђ (A РЄњРѓђрхЌ C)
_РѕўРѓђрхЌ_ G F = cmpРѓђрхЌ (G , F)
