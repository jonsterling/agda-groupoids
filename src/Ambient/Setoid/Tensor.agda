{-# OPTIONS --without-K #-}

module Ambient.Setoid.Tensor where

open import Agda.Primitive
import Ambient.Setoid.Base as S
open import Ambient.Setoid.Map
open import Ambient.Setoid.Tensor.Boot public
open import Type as T

¤ђРѓђ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (A РіЌ B) РЄњРѓђрхЌ A
_$Рѓђ_ ¤ђРѓђ = ¤ђРЂ░Рѓђ
_$РѓЂ_ ¤ђРѓђ = ¤ђРЂ░Рѓђ

¤ђРѓЂ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (A РіЌ B) РЄњРѓђрхЌ B
_$Рѓђ_ ¤ђРѓЂ = ¤ђ┬╣Рѓђ
_$РѓЂ_ ¤ђРѓЂ = ¤ђ┬╣Рѓђ

РЪе-,-РЪЕ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {X : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ ((X РЄњРѓђ╦б A) РіЌ (X РЄњРѓђ╦б B)) РЄњРѓђрхЌ (X РЄњРѓђ╦б A РіЌ B)
_$Рѓђ_ (_$Рѓђ_ РЪе-,-РЪЕ FG) =
  РЪе ¤ђРЂ░Рѓђ FG $Рѓђ_ ,Рѓђ ¤ђ┬╣Рѓђ FG $Рѓђ_ РЪЕ
_$РѓЂ_ (_$Рѓђ_ РЪе-,-РЪЕ FG) =
  РЪе ¤ђРЂ░Рѓђ FG $РѓЂ_ ,Рѓђ ¤ђ┬╣Рѓђ FG $РѓЂ_ РЪЕ
comРѓЂ (_$РѓЂ_ РЪе-,-РЪЕ x) =
  РЪе comРѓЂрхЌРђ▓ ├ЌРѓђ comРѓЂрхЌРђ▓ РЪЕ x

РЪе-РіЌ-РЪЕ
  : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░ РёЊРѓЃрхњ РёЊРѓЃ╩░}
  Рєњ {XРѓђ : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
  Рєњ {XРѓЂ : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЃрхњ РёЊРѓЃ╩░}
  Рєњ ((XРѓђ РЄњРѓђ╦б A) РіЌ (XРѓЂ РЄњРѓђ╦б B)) РЄњРѓђрхЌ ((XРѓђ РіЌ XРѓЂ) РЄњРѓђ╦б (A РіЌ B))
_$Рѓђ_ (_$Рѓђ_ РЪе-РіЌ-РЪЕ FG) =
  РЪе ¤ђРЂ░Рѓђ FG $Рѓђ_ ├ЌРѓђ ¤ђ┬╣Рѓђ FG $Рѓђ_ РЪЕ
_$РѓЂ_ (_$Рѓђ_ РЪе-РіЌ-РЪЕ FG) =
  РЪе ¤ђРЂ░Рѓђ FG $РѓЂ_ ├ЌРѓђ ¤ђ┬╣Рѓђ FG $РѓЂ_ РЪЕ
comРѓЂ (_$РѓЂ_ РЪе-РіЌ-РЪЕ x) =
  РЪе comРѓЂрхЌРђ▓ ├ЌРѓђ comРѓЂрхЌРђ▓ РЪЕ x

-- ap-lhsРѓђ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РіЌ B РЄњРѓђрхЌ C)
--   Рєњ (a : S.obj A)
--   Рєњ B РЄњРѓђрхЌ C
-- _$Рѓђ_ (ap-lhsРѓђ F a) = T.Ten.ap-lhs (F $Рѓђ_) a
-- _$РѓЂ_ (ap-lhsРѓђ {A = A} F a) = T.Ten.ap-lhs (F $РѓЂ_) (S.idnрхЌ A _)

-- ap-rhsРѓђ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РіЌ B РЄњРѓђрхЌ C)
--   Рєњ (b : S.obj B)
--   Рєњ A РЄњРѓђрхЌ C
-- _$Рѓђ_ (ap-rhsРѓђ F b) = T.Ten.ap-rhs (F $Рѓђ_) b
-- _$РѓЂ_ (ap-rhsРѓђ {B = B} F b) = T.Ten.ap-rhs (F $РѓЂ_) (S.idnрхЌ B _)

-- ap-lhsРѓЂ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РіЌ B РЄњРѓђрхЌ C)
--   Рєњ {aРѓђ aРѓЂ : S.obj A}
--   Рєњ (f : S.homрхЌ A (aРѓђ , aРѓЂ))
--   Рєњ ap-lhsРѓђ F aРѓђ РЄњРѓЂ ap-lhsРѓђ F aРѓЂ
-- comРѓЂ (ap-lhsРѓЂ {B = B} F f) = F $РѓЂ (f , S.idnрхЌ B _)

-- ap-rhsРѓЂ
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РіЌ B РЄњРѓђрхЌ C)
--   Рєњ {bРѓђ bРѓЂ : S.obj B}
--   Рєњ (f : S.homрхЌ B (bРѓђ , bРѓЂ))
--   Рєњ ap-rhsРѓђ F bРѓђ РЄњРѓЂ ap-rhsРѓђ F bРѓЂ
-- comРѓЂ (ap-rhsРѓЂ {A = A} F f) = F $РѓЂ (S.idnрхЌ A _ , f)

-- curry
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РіЌ B РЄњРѓђрхЌ C)
--   Рєњ A РЄњРѓђрхЌ (B РЄњРѓђ╦б C)
-- _$Рѓђ_ (curry F) = ap-lhsРѓђ F
-- _$РѓЂ_ (curry F) = ap-lhsРѓЂ F

-- uncurry
--   : Рѕђ {d} ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ {A : S.­ЮћіРѓЂ d РёЊРѓђрхњ РёЊРѓђ╩░}
--   Рєњ {B : S.­ЮћіРѓЂ d РёЊРѓЂрхњ РёЊРѓЂ╩░}
--   Рєњ {C : S.­ЮћіРѓЂ d РёЊРѓѓрхњ РёЊРѓѓ╩░}
--   Рєњ (F : A РЄњРѓђрхЌ (B РЄњРѓђ╦б C))
--   Рєњ A РіЌ B РЄњРѓђрхЌ C
-- _$Рѓђ_ (uncurry F) =
--   T.Ten.uncurry _$Рѓђ_ T.Map.Рѕў T.Ten.РЪе (F $Рѓђ_) РіЌРѓђ T.Map.idn РЪЕ
-- _$РѓЂ_ (uncurry {C = C} F) (fРѓђ , fРѓЂ) =
--   S.cmpрхЌ C (comРѓЂ (F $РѓЂ fРѓђ) , (F $Рѓђ _) $РѓЂ fРѓЂ)
