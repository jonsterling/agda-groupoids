{-# OPTIONS --without-K #-}

module Ambient.Type.Map where

open import Agda.Primitive
open import Ambient.Type.Base
open import Ambient.Type.Discrete as â‰¡
  using (_â‰¡â‚€_)
open import Ambient.Type.Map.Boot public
open import Ambient.Type.Product.Boot
open import Ambient.Type.Terminal

infixr 0 _â‡’â‚€,â‚_

record _â‡’â‚€,â‚_ ..{â„“â‚€áµ’ â„“â‚áµ’}
  {A : ğ”Šâ‚€ â„“â‚€áµ’}
  {B : ğ”Šâ‚€ â„“â‚áµ’}
  (F G : A â‡’â‚€,â‚€ B)
    : Set (â„“â‚€áµ’ âŠ” â„“â‚áµ’) where
  no-eta-equality
  infixl 1 _Â·â‚€,â‚_
  field
    _Â·â‚€,â‚_
      : âˆ€ x
      â†’ F x â‰¡â‚€ G x
open _â‡’â‚€,â‚_ public

idnâ‚
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’}
  â†’ (F : A â‡’â‚€,â‚€ B)
  â†’ ğŸ™â‚€ {lzero} â‡’â‚€,â‚€ (F â‡’â‚€,â‚ F)
_Â·â‚€,â‚_ (idnâ‚ F *) a = â‰¡.idn *

cmpâ‚
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’}
  â†’ {F G H : A â‡’â‚€,â‚€ B}
  â†’ (G â‡’â‚€,â‚ H) Ã—â‚€ (F â‡’â‚€,â‚ G)
  â†’ F â‡’â‚€,â‚ H
_Â·â‚€,â‚_ (cmpâ‚ (Î² , Î±)) a = â‰¡.cmp (Î² Â·â‚€,â‚ a , Î± Â·â‚€,â‚ a)

invâ‚
  : âˆ€ {â„“â‚€áµ’ â„“â‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’}
  â†’ {F G : A â‡’â‚€,â‚€ B}
  â†’ (F â‡’â‚€,â‚ G) â‡’â‚€,â‚€ (G â‡’â‚€,â‚ F)
_Â·â‚€,â‚_ (invâ‚ Î±) a = â‰¡.inv (Î± Â·â‚€,â‚ a)

cmpâ‚-â‚€wâ‚
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’ â„“â‚‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’} {C : ğ”Šâ‚€ â„“â‚‚áµ’}
  â†’ {F G : A â‡’â‚€,â‚€ B}
  â†’ (HÎ± : (B â‡’â‚€,â‚€ C) Ã—â‚€ (F â‡’â‚€,â‚ G))
  â†’ (Ï€â°â‚€ HÎ± âˆ˜â‚€ F) â‡’â‚€,â‚ (Ï€â°â‚€ HÎ± âˆ˜â‚€ G)
_Â·â‚€,â‚_ (cmpâ‚-â‚€wâ‚ (H , Î±)) a = H â‰¡.$â‚ (Î± Â·â‚€,â‚ a)

cmpâ‚-â‚wâ‚€_
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’ â„“â‚‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’} {C : ğ”Šâ‚€ â„“â‚‚áµ’}
  â†’ {G H : B â‡’â‚€,â‚€ C}
  â†’ (Î²F : (G â‡’â‚€,â‚ H) Ã—â‚€ (A â‡’â‚€,â‚€ B))
  â†’ (G âˆ˜â‚€ Ï€Â¹â‚€ Î²F) â‡’â‚€,â‚ (H âˆ˜â‚€ Ï€Â¹â‚€ Î²F)
_Â·â‚€,â‚_ (cmpâ‚-â‚wâ‚€ (Î² , F)) a = Î² Â·â‚€,â‚ (F Â·â‚€,â‚€ a)

cmpâ‚-hâ‚€
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’ â„“â‚‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’} {C : ğ”Šâ‚€ â„“â‚‚áµ’}
  â†’ {F G : A â‡’â‚€,â‚€ B}
  â†’ {H K : B â‡’â‚€,â‚€ C}
  â†’ (Î²Î± : (H â‡’â‚€,â‚ K) Ã—â‚€ (F â‡’â‚€,â‚ G))
  â†’ (H âˆ˜â‚€ F) â‡’â‚€,â‚ (K âˆ˜â‚€ G)
_Â·â‚€,â‚_ (cmpâ‚-hâ‚€ {F = F}{K = K} (Î² , Î±)) a =
  â‰¡.cmp (K â‰¡.$â‚ (Î± Â·â‚€,â‚ a) , Î² Â·â‚€,â‚ (F Â·â‚€,â‚€ a))

cmpâ‚-hâ‚
  : âˆ€ ..{â„“â‚€áµ’ â„“â‚áµ’ â„“â‚‚áµ’}
  â†’ {A : ğ”Šâ‚€ â„“â‚€áµ’} {B : ğ”Šâ‚€ â„“â‚áµ’} {C : ğ”Šâ‚€ â„“â‚‚áµ’}
  â†’ {F G : A â‡’â‚€,â‚€ B}
  â†’ {H K : B â‡’â‚€,â‚€ C}
  â†’ (Î²Î± : (H â‡’â‚€,â‚ K) Ã—â‚€ (F â‡’â‚€,â‚ G))
  â†’ (H âˆ˜â‚€ F) â‡’â‚€,â‚ (K âˆ˜â‚€ G)
_Â·â‚€,â‚_ (cmpâ‚-hâ‚ {F = F}{G = G}{H = H} (Î² , Î±)) a =
  â‰¡.cmp (Î² Â·â‚€,â‚ (G Â·â‚€,â‚€ a) , H â‰¡.$â‚ (Î± Â·â‚€,â‚ a))
